# 模块 2：核心工具与工作流

## 学习目标
- ✅ 掌握 Claude Code 的所有核心工具
- ✅ 理解常见工作流程
- ✅ 学会文件操作和项目导航

## 核心工具详解

### 1. Read - 读取文件
**用途**：查看文件内容，支持指定行范围

**使用场景**：
- 查看代码实现
- 分析配置文件
- 阅读文档

**最佳实践**：
```
"请读取 src/utils/helper.js 文件"
"查看 package.json 的 scripts 部分"
"显示 config.js 中的数据库配置"
```

### 2. Write - 创建文件
**用途**：创建新文件并写入内容

**使用场景**：
- 创建新模块
- 生成配置文件
- 添加测试文件

**最佳实践**：
```
"创建一个新的 React 组件 UserProfile.jsx"
"生成 .eslintrc.json 配置文件"
"创建 API 路由文件 /routes/users.js"
```

### 3. Edit - 编辑文件
**用途**：精确修改现有文件的特定部分

**使用场景**：
- 修复 bug
- 添加新功能
- 更新配置

**最佳实践**：
```
"在 app.js 中添加错误处理中间件"
"修改 User 类的 validate 方法，添加邮箱验证"
"更新 API 端点的响应格式"
```

### 4. Glob - 文件模式匹配
**用途**：查找符合特定模式的文件

**使用场景**：
- 查找所有测试文件
- 定位特定类型的文件
- 批量操作

**模式示例**：
- `**/*.test.js` - 所有测试文件
- `src/**/*.tsx` - src 下所有 TypeScript React 文件
- `*.config.js` - 所有配置文件

### 5. Grep - 内容搜索
**用途**：在文件中搜索特定内容

**使用场景**：
- 查找函数定义
- 搜索特定字符串
- 代码审计

**搜索示例**：
```
"在项目中搜索所有使用 useState 的地方"
"找到定义 API_KEY 的位置"
"查找所有 TODO 注释"
```

### 6. Bash - 终端命令
**用途**：执行系统命令

**使用场景**：
- 运行测试
- 安装依赖
- Git 操作

**常用命令**：
```bash
npm install
npm test
git status
```

---

## 常见工作流程

### 工作流 1：Bug 修复
**步骤**：
1. **理解问题** - 阅读错误信息或 bug 描述
2. **定位代码** - 使用 Grep 找到相关代码
3. **分析原因** - 使用 Read 查看完整上下文
4. **实施修复** - 使用 Edit 修改代码
5. **验证修复** - 运行测试确认问题解决

**示例请求**：
```
"在运行 npm test 时，UserService.test.js 失败了，
错误信息是 'Cannot read property name of undefined'，
请帮我找到并修复这个问题"
```

### 工作流 2：功能开发
**步骤**：
1. **规划设计** - 明确功能需求和技术方案
2. **创建文件** - 使用 Write 创建必要的文件
3. **实现功能** - 编写核心逻辑
4. **添加测试** - 确保代码质量
5. **更新文档** - 说明新功能的使用

**示例请求**：
```
"请帮我实现用户登录功能：
1. 创建 /api/login 端点
2. 验证用户名和密码
3. 生成 JWT token
4. 返回用户信息和 token
5. 添加相应的单元测试"
```

### 工作流 3：代码重构
**步骤**：
1. **识别问题** - 找出需要重构的代码
2. **提取公共逻辑** - 识别重复代码
3. **设计改进方案** - 规划重构策略
4. **逐步重构** - 小步快跑，保持可测试
5. **验证功能** - 确保重构没有破坏功能

**示例请求**：
```
"services 目录下的文件有大量重复的错误处理代码，
请帮我提取公共逻辑，创建一个统一的错误处理工具"
```

### 工作流 4：代码审查
**步骤**：
1. **读取代码** - 查看需要审查的文件
2. **检查问题** - 识别潜在问题
3. **提供建议** - 给出改进方向
4. **应用改进** - 实施优化方案

---

## 实践练习

### 练习 2.1：工具掌握
**目标**：熟练使用每个核心工具

**任务清单**：
1. 使用 Glob 找到所有 `.js` 文件
2. 使用 Grep 搜索所有的 `console.log`
3. 使用 Read 查看配置文件
4. 使用 Write 创建新的工具模块
5. 使用 Edit 优化现有函数
6. 使用 Bash 运行测试

**验证**：
- [ ] 成功使用所有 6 个工具
- [ ] 理解每个工具的适用场景
- [ ] 能够选择合适的工具完成任务

### 练习 2.2：重构实战
**目标**：使用 Claude Code 重构提供的代码

**任务**：
使用 `refactor-example/` 目录中的代码
1. 识别代码异味（重复代码、长函数等）
2. 提取公共逻辑
3. 优化函数结构
4. 添加适当的错误处理
5. 改进变量命名

**提示词**：
```
"请分析 refactor-example 目录中的代码：
1. 找出代码中的问题和改进空间
2. 提供详细的重构建议
3. 逐步实施重构
4. 确保重构后功能不变"
```

**验证**：
- [ ] 识别了所有主要问题
- [ ] 重构后代码更清晰
- [ ] 没有破坏原有功能
- [ ] 代码可维护性提升

### 练习 2.3：项目导航
**目标**：在复杂项目中快速定位代码

**准备**：使用 `navigation-practice/` 项目

**任务**：
1. 找到用户认证的入口点
2. 追踪数据库查询的调用链
3. 定位所有的 API 端点定义
4. 找出配置加载的流程
5. 识别所有的中间件

**提示词示例**：
```
"在这个项目中，用户认证是如何实现的？
请帮我找到：
1. 认证中间件的定义位置
2. Token 验证的实现
3. 用户信息的获取逻辑"
```

**验证**：
- [ ] 能够快速定位功能入口
- [ ] 理解代码的调用关系
- [ ] 掌握项目的整体结构

### 练习 2.4：综合工作流
**目标**：完整执行一个开发流程

**任务描述**：
在一个待办事项应用中添加优先级功能

**步骤**：
1. 分析现有代码结构
2. 设计优先级功能（高/中/低）
3. 修改数据模型
4. 更新 API 端点
5. 修改前端展示
6. 添加测试
7. 更新文档

**验证**：
- [ ] 功能完整实现
- [ ] 代码质量良好
- [ ] 测试覆盖充分
- [ ] 文档更新完整

---

## 最佳实践

### 1. 请求的艺术
**✅ 好的请求**：
- 清晰具体
- 包含上下文
- 说明期望结果

**❌ 避免的请求**：
- 过于模糊
- 缺少信息
- 多个不相关任务

### 2. 任务分解
复杂任务应该分解为：
1. 独立的小步骤
2. 可验证的检查点
3. 逐步递进的过程

### 3. 上下文管理
- 提供足够的背景信息
- 说明项目的技术栈
- 指出特殊的约束条件

### 4. 验证习惯
每次修改后：
- 检查语法错误
- 运行相关测试
- 验证功能正确性

---

## 自我测试

### 工具选择题
为以下场景选择最合适的工具：

1. 需要查看所有测试文件 → _______
2. 想找到某个函数的定义 → _______
3. 创建新的配置文件 → _______
4. 修改现有函数的逻辑 → _______
5. 查看文件的完整内容 → _______
6. 运行项目的测试套件 → _______

### 实践测试
完成以下综合任务：

**任务**：重构一个电商购物车模块
1. 识别当前实现的问题
2. 提取可复用的逻辑
3. 优化数据结构
4. 改进错误处理
5. 添加单元测试
6. 更新使用文档

### 思考题
1. 什么时候应该使用 Grep 而不是 Read？
2. 如何在大型项目中高效导航？
3. 重构时如何确保不破坏功能？

---

## 参考资料
- [工具使用指南](https://docs.claude.com/en/docs/claude-code/tools)
- [工作流最佳实践](https://docs.claude.com/en/docs/claude-code/workflows)

## 下一步
完成本模块后，继续学习 [模块 3：Git 集成与版本控制](../module-3/README.md)
