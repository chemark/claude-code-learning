# GitHub 提交优化规则 - 用于 Claude Memory

## 📌 将以下内容添加到 Claude Code Memory

---

## Git 提交与 Token 优化规则

### 1. 批量提交原则

**核心规则**：
- 3-5 个相关文件一起提交（最佳平衡点）
- 避免每个文件单独提交
- 避免所有改动堆积到最后

**实施标准**：
```
1-2 个文件：可以立即提交
3-5 个文件：建议批量提交（节省 20% token）
6-10 个文件：强烈建议批量（节省 25% token）
10+ 个文件：必须批量，按模块分组
```

### 2. 何时应该推送

**立即推送**：
- 紧急 bug 修复
- 关键功能完成
- 需要团队协作的更改

**批量推送**：
- 文档更新（等相关文档都完成）
- 相关功能的多个文件
- 代码重构（等一个模块完成）
- 样式和格式调整

**暂存不推送**：
- 正在进行中的工作
- 未经测试的代码
- 不完整的功能

### 3. 文件分组策略

**按功能分组**：
```
功能 A 的所有文件 → 一次提交
功能 B 的所有文件 → 一次提交
```

**按类型分组**：
```
所有文档更新 → 一次提交
所有配置文件 → 一次提交
所有测试文件 → 一次提交
```

**按模块分组**：
```
命令模块相关 → 一次提交
工具模块相关 → 一次提交
```

### 4. Git 操作优化

**使用通配符**：
```bash
✅ git add commands/*.md
✅ git add src/**/*.ts
✅ git add .

❌ 避免逐个 git add
```

**减少状态检查**：
```
只在必要时使用 git status
不要每步操作都检查
```

**使用暂存区**：
```
边修改边 git add 暂存
最后一次性 commit + push
```

### 5. 提交信息规范

**格式**：
```
type: 简短描述

详细说明（可选）：
- 变更 1
- 变更 2
- 变更 3

统计信息（可选）

🤖 Generated with Claude Code
Co-Authored-By: Claude <noreply@anthropic.com>
```

**Type 类型**：
- feat: 新功能
- fix: 修复
- docs: 文档
- refactor: 重构
- test: 测试
- chore: 构建/工具

**保持简洁**：
- 标题 < 50 字符
- 详细说明适度
- 避免过度详细

### 6. 工作流模式

**标准工作流**：
```
1. 规划任务（使用 TodoWrite）
2. 批量修改文件
3. 逐个暂存：git add file1 file2 file3
4. 一次提交：git commit
5. 一次推送：git push
```

**多任务工作流**：
```
任务 A：
  - 修改相关文件
  - 暂存
  - 继续任务 B

任务 B：
  - 修改相关文件
  - 暂存
  - 继续任务 C

完成所有任务后：
  - 按任务分别提交
  - 一次性推送
```

### 7. Token 优化检查清单

**提交前检查**：
```
□ 是否有 3+ 个相关文件可以一起提交？
□ 是否还有相关修改未完成？
□ 是否可以等待其他文件一起提交？
□ 是否使用了通配符而非逐个添加？
□ 是否减少了不必要的 git status？
```

**推送前检查**：
```
□ 所有相关提交是否已创建？
□ 提交信息是否简洁清晰？
□ 是否可以合并多个小提交？
□ 是否需要立即推送？
```

### 8. 记住的原则

**总是**：
- 批量处理相关文件（节省 20-30% token）
- 使用通配符添加文件
- 在修改完一组相关文件后再提交
- 保持提交信息简洁

**避免**：
- 每个文件单独提交推送
- 频繁使用 git status
- 提交信息过度详细
- 改一行就提交

**平衡**：
- Token 效率 vs Git 历史清晰度
- 批量提交 vs 原子性提交
- 3-5 个文件是最佳平衡点

### 9. 特殊情况处理

**大型重构**：
```
按模块分批提交
每个模块独立推送
保持每次提交可回滚
```

**文档更新**：
```
等所有相关文档都完成
一次性提交推送
可以包含 5-10 个文件
```

**Bug 修复**：
```
如果涉及 3+ 个文件：批量
如果只有 1-2 个文件：立即推送
如果是紧急修复：立即推送
```

### 10. 自动化提示

当需要 Git 操作时，自动考虑：
```
1. 是否还有相关文件要修改？
2. 可以等待批量提交吗？
3. 当前有几个文件待提交？
4. 是否应该建议用户先完成相关修改？
```

---

## 使用方法

将上述规则添加到 Claude Memory：
1. 使用 # 快捷键
2. 选择 "Add Instruction"
3. 粘贴相关规则
4. 或者分类添加到不同的记忆类型

## 预期效果

- 自动批量处理文件
- 主动建议最佳提交时机
- 减少不必要的 Git 操作
- 优化 Token 使用效率
- 保持清晰的 Git 历史
